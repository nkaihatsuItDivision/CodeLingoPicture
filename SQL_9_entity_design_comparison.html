<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>エンティティ設計と正規化効果比較図</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #74b9ff 0%, #0984e3 100%);
            min-height: 100vh;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
        }
        
        .title {
            text-align: center;
            color: #2c3e50;
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 30px;
            padding-bottom: 15px;
            border-bottom: 3px solid #e74c3c;
        }
        
        .comparison-container {
            display: grid;
            grid-template-columns: 1fr 50px 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .design-section {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 20px;
            border: 2px solid #dee2e6;
        }
        
        .bad-design {
            border-color: #e74c3c;
            background: linear-gradient(135deg, #fff5f5, #ffe6e6);
        }
        
        .good-design {
            border-color: #27ae60;
            background: linear-gradient(135deg, #f0fff4, #e6ffe6);
        }
        
        .section-header {
            text-align: center;
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 15px;
            padding: 10px;
            border-radius: 10px;
        }
        
        .bad-header {
            background: #e74c3c;
            color: white;
        }
        
        .good-header {
            background: #27ae60;
            color: white;
        }
        
        .arrow-section {
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 30px;
            color: #3498db;
        }
        
        .table-container {
            background: white;
            border-radius: 10px;
            padding: 15px;
            margin: 10px 0;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        .table-title {
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 10px;
            font-size: 14px;
        }
        
        .table-structure {
            font-family: 'Courier New', monospace;
            font-size: 12px;
            background: #f8f9fa;
            padding: 10px;
            border-radius: 5px;
            border-left: 4px solid #17a2b8;
        }
        
        .problems-list {
            background: #fff2f2;
            border: 1px solid #e74c3c;
            border-radius: 8px;
            padding: 10px;
            margin: 10px 0;
        }
        
        .problems-list ul {
            margin: 5px 0;
            padding-left: 20px;
        }
        
        .problems-list li {
            color: #c0392b;
            font-size: 12px;
            margin: 3px 0;
        }
        
        .benefits-list {
            background: #f0fff4;
            border: 1px solid #27ae60;
            border-radius: 8px;
            padding: 10px;
            margin: 10px 0;
        }
        
        .benefits-list ul {
            margin: 5px 0;
            padding-left: 20px;
        }
        
        .benefits-list li {
            color: #27ae60;
            font-size: 12px;
            margin: 3px 0;
        }
        
        .entities-flow {
            display: flex;
            justify-content: space-around;
            align-items: center;
            margin: 20px 0;
            flex-wrap: wrap;
            gap: 15px;
        }
        
        .entity-box {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 12px 16px;
            border-radius: 10px;
            font-size: 12px;
            font-weight: bold;
            text-align: center;
            min-width: 100px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
        
        .entity-arrow {
            color: #3498db;
            font-size: 20px;
        }
        
        .normalization-levels {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        
        .norm-level {
            background: white;
            border-radius: 10px;
            padding: 15px;
            border-left: 5px solid #9b59b6;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        .norm-title {
            font-weight: bold;
            color: #8e44ad;
            margin-bottom: 8px;
            font-size: 14px;
        }
        
        .norm-description {
            font-size: 12px;
            color: #5a6c7d;
            line-height: 1.4;
        }
        
        .highlight {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 8px;
            padding: 15px;
            margin: 20px 0;
            font-size: 14px;
            color: #856404;
        }
        
        .highlight-title {
            font-weight: bold;
            margin-bottom: 5px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="title">🔄 エンティティ設計：正規化による改善効果</div>
        
        <div class="comparison-container">
            <!-- Before: 非正規化設計 -->
            <div class="design-section bad-design">
                <div class="section-header bad-header">❌ 非正規化設計（問題のある設計）</div>
                
                <div class="table-container">
                    <div class="table-title">student_bad テーブル</div>
                    <div class="table-structure">
id | name | age | department_name | department_code | capacity | email<br>
1  | 田中 | 20  | コンピュータ科  | CS             | 120      | tanaka@...<br>
2  | 佐藤 | 21  | コンピュータ科  | CS             | 120      | sato@...<br>
3  | 山田 | 19  | 電気電子工学科  | EE             | 100      | yamada@...<br>
4  | 鈴木 | 22  | コンピュータ科  | CS             | 120      | suzuki@...
                    </div>
                </div>
                
                <div class="problems-list">
                    <strong>🚨 発生する問題</strong>
                    <ul>
                        <li>学科情報の重複保存（データ冗長性）</li>
                        <li>学科名変更時の更新異常（複数箇所修正必要）</li>
                        <li>学科のみ登録時の挿入異常</li>
                        <li>学生削除時の学科情報消失リスク</li>
                        <li>ストレージ使用量の無駄な増加</li>
                        <li>データ不整合の発生可能性</li>
                    </ul>
                </div>
            </div>
            
            <!-- Arrow -->
            <div class="arrow-section">
                ➡️<br>
                <small style="font-size: 12px; color: #666;">正規化</small>
            </div>
            
            <!-- After: 正規化設計 -->
            <div class="design-section good-design">
                <div class="section-header good-header">✅ 正規化設計（改善された設計）</div>
                
                <div class="table-container">
                    <div class="table-title">students テーブル</div>
                    <div class="table-structure">
id | name | age | department_id | email<br>
1  | 田中 | 20  | 1            | tanaka@...<br>
2  | 佐藤 | 21  | 1            | sato@...<br>
3  | 山田 | 19  | 2            | yamada@...<br>
4  | 鈴木 | 22  | 1            | suzuki@...
                    </div>
                </div>
                
                <div class="table-container">
                    <div class="table-title">departments テーブル</div>
                    <div class="table-structure">
id | department_name  | department_code | capacity<br>
1  | コンピュータ科   | CS             | 120<br>
2  | 電気電子工学科   | EE             | 100<br>
3  | 機械工学科       | ME             | 80
                    </div>
                </div>
                
                <div class="benefits-list">
                    <strong>✨ 改善効果</strong>
                    <ul>
                        <li>データ重複の完全排除</li>
                        <li>学科情報の一元管理</li>
                        <li>更新処理の簡素化</li>
                        <li>データ整合性の確保</li>
                        <li>ストレージ効率の向上</li>
                        <li>拡張性の向上</li>
                    </ul>
                </div>
            </div>
        </div>
        
        <!-- 完全なエンティティ構造 -->
        <div class="highlight">
            <div class="highlight-title">🏗️ 完全な5エンティティ構造</div>
            学生管理システムの完全なエンティティ設計では、以下の5つのテーブルが連携します
        </div>
        
        <div class="entities-flow">
            <div class="entity-box">departments<br>🏫 学科</div>
            <div class="entity-arrow">→</div>
            <div class="entity-box">students<br>👥 学生</div>
            <div class="entity-arrow">→</div>
            <div class="entity-box">grades<br>📝 成績</div>
            <div class="entity-arrow">←</div>
            <div class="entity-box">subjects<br>📚 科目</div>
            <div class="entity-arrow">←</div>
            <div class="entity-box">teachers<br>👨‍🏫 教員</div>
        </div>
        
        <!-- 正規化レベル -->
        <div class="normalization-levels">
            <div class="norm-level">
                <div class="norm-title">🥇 第1正規形（1NF）</div>
                <div class="norm-description">
                    各フィールドに単一の値のみ格納<br>
                    例：住所フィールドに「都道府県,市区町村」のような複数値を格納しない
                </div>
            </div>
            <div class="norm-level">
                <div class="norm-title">🥈 第2正規形（2NF）</div>
                <div class="norm-description">
                    部分関数従属を排除<br>
                    例：学科情報を別テーブルに分離し、studentsテーブルでは department_id のみ保持
                </div>
            </div>
            <div class="norm-level">
                <div class="norm-title">🥉 第3正規形（3NF）</div>
                <div class="norm-description">
                    推移的関数従属を排除<br>
                    例：教員情報を別テーブルに分離し、間接的な依存関係を解消
                </div>
            </div>
        </div>
        
        <div class="highlight">
            <div class="highlight-title">📊 実用効果の数値例</div>
            1,000名の学生データにおいて：<br>
            • <strong>ストレージ削減</strong>：約60%の容量削減<br>
            • <strong>更新効率</strong>：学科名変更が1回の操作で完了（従来は1,000回）<br>
            • <strong>整合性</strong>：データ不整合リスクを完全排除
        </div>
    </div>
</body>
</html>