<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Entity↔データベース自動変換メカニズム</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
        }
        
        .title {
            text-align: center;
            color: #667eea;
            font-size: 2.2rem;
            font-weight: bold;
            margin-bottom: 10px;
        }
        
        .subtitle {
            text-align: center;
            color: #666;
            font-size: 1.1rem;
            margin-bottom: 40px;
        }
        
        .conversion-section {
            display: grid;
            grid-template-columns: 1fr auto 1fr;
            gap: 30px;
            align-items: center;
            margin-bottom: 40px;
        }
        
        .entity-side {
            background: linear-gradient(135deg, #27ae60 0%, #219a52 100%);
            color: white;
            padding: 25px;
            border-radius: 12px;
        }
        
        .database-side {
            background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
            color: white;
            padding: 25px;
            border-radius: 12px;
        }
        
        .conversion-arrow {
            background: #667eea;
            color: white;
            padding: 15px;
            border-radius: 50px;
            text-align: center;
            font-weight: bold;
            font-size: 1.1rem;
            min-width: 120px;
        }
        
        .section-title {
            font-size: 1.3rem;
            font-weight: bold;
            margin-bottom: 15px;
            text-align: center;
        }
        
        .code-block {
            background: rgba(0,0,0,0.2);
            padding: 15px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            margin: 10px 0;
            overflow-x: auto;
        }
        
        .mapping-table {
            background: #f8f9fa;
            border-radius: 8px;
            overflow: hidden;
            margin: 20px 0;
        }
        
        .mapping-header {
            background: #667eea;
            color: white;
            padding: 15px;
            text-align: center;
            font-weight: bold;
        }
        
        .mapping-row {
            display: grid;
            grid-template-columns: 1fr auto 1fr;
            align-items: center;
            padding: 12px 15px;
            border-bottom: 1px solid #dee2e6;
        }
        
        .mapping-row:last-child {
            border-bottom: none;
        }
        
        .mapping-java {
            color: #27ae60;
            font-family: 'Courier New', monospace;
            font-weight: bold;
        }
        
        .mapping-sql {
            color: #3498db;
            font-family: 'Courier New', monospace;
            font-weight: bold;
        }
        
        .operation-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }
        
        .operation-card {
            border: 2px solid #667eea;
            border-radius: 12px;
            overflow: hidden;
        }
        
        .operation-header {
            background: #667eea;
            color: white;
            padding: 15px;
            text-align: center;
            font-weight: bold;
        }
        
        .operation-content {
            padding: 20px;
            background: #f8f9ff;
        }
        
        .operation-example {
            background: #2d3748;
            color: #e2e8f0;
            padding: 15px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 0.85rem;
            margin: 10px 0;
        }
        
        .highlight-box {
            background: linear-gradient(135deg, #ffc107 0%, #e6ac00 100%);
            color: #333;
            padding: 20px;
            border-radius: 12px;
            text-align: center;
            margin: 30px 0;
            font-weight: bold;
        }
        
        .conversion-icon {
            font-size: 1.5rem;
            margin: 0 10px;
        }
        
        @media (max-width: 768px) {
            .conversion-section {
                grid-template-columns: 1fr;
                gap: 20px;
            }
            
            .conversion-arrow {
                margin: 10px auto;
            }
            
            .mapping-row {
                grid-template-columns: 1fr;
                gap: 10px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1 class="title">Entity↔データベース自動変換メカニズム</h1>
        <p class="subtitle">MyBatisによるオブジェクト⇔SQLの魔法的な自動変換</p>
        
        <div class="conversion-section">
            <div class="entity-side">
                <div class="section-title">🟢 Week 8.5 Studentオブジェクト</div>
                <div class="code-block">
@Entity<br>
@Data<br>
@Builder<br>
public class Student {<br>
    private Long id;<br>
    private String name;<br>
    private String email;<br>
    private LocalDate birthDate;<br>
    private Long departmentId;<br>
    private BigDecimal gpa;<br>
}
                </div>
            </div>
            
            <div class="conversion-arrow">
                <span class="conversion-icon">⇄</span><br>
                MyBatis<br>
                自動変換
            </div>
            
            <div class="database-side">
                <div class="section-title">🔵 データベーステーブル</div>
                <div class="code-block">
CREATE TABLE students (<br>
    id BIGINT PRIMARY KEY,<br>
    name VARCHAR(100),<br>
    email VARCHAR(255),<br>
    birth_date DATE,<br>
    department_id BIGINT,<br>
    gpa DECIMAL(3,2)<br>
);
                </div>
            </div>
        </div>
        
        <div class="mapping-table">
            <div class="mapping-header">🔄 キャメルケース ⇔ スネークケース 自動変換</div>
            <div class="mapping-row">
                <span class="mapping-java">birthDate</span>
                <span>⇄</span>
                <span class="mapping-sql">birth_date</span>
            </div>
            <div class="mapping-row">
                <span class="mapping-java">departmentId</span>
                <span>⇄</span>
                <span class="mapping-sql">department_id</span>
            </div>
            <div class="mapping-row">
                <span class="mapping-java">createdAt</span>
                <span>⇄</span>
                <span class="mapping-sql">created_at</span>
            </div>
            <div class="mapping-row">
                <span class="mapping-java">studentNumber</span>
                <span>⇄</span>
                <span class="mapping-sql">student_number</span>
            </div>
        </div>
        
        <div class="highlight-box">
            🎯 mybatis.configuration.map-underscore-to-camel-case=true<br>
            この設定1行で、Java命名規則とSQL命名規則が自動で相互変換される！
        </div>
        
        <div class="operation-grid">
            <div class="operation-card">
                <div class="operation-header">INSERT 変換パターン</div>
                <div class="operation-content">
                    <strong>Java → SQL</strong>
                    <div class="operation-example">
Student student = Student.builder()<br>
    .name("田中太郎")<br>
    .email("tanaka@example.com")<br>
    .birthDate(LocalDate.of(2000,4,1))<br>
    .departmentId(1L)<br>
    .build();<br><br>
mapper.save(student);
                    </div>
                    <strong>自動生成SQL</strong>
                    <div class="operation-example">
INSERT INTO students (<br>
    name, email, birth_date, department_id<br>
) VALUES (<br>
    '田中太郎', 'tanaka@example.com',<br>
    '2000-04-01', 1<br>
);
                    </div>
                </div>
            </div>
            
            <div class="operation-card">
                <div class="operation-header">SELECT 変換パターン</div>
                <div class="operation-content">
                    <strong>SQL → Java</strong>
                    <div class="operation-example">
Student student = mapper.findById(1L);
                    </div>
                    <strong>自動実行SQL</strong>
                    <div class="operation-example">
SELECT id, name, email,<br>
       birth_date, department_id, gpa<br>
FROM students<br>
WHERE id = 1;
                    </div>
                    <strong>自動変換結果</strong>
                    <div class="operation-example">
Student {<br>
    id: 1,<br>
    name: "田中太郎",<br>
    email: "tanaka@example.com",<br>
    birthDate: LocalDate.of(2000,4,1),<br>
    departmentId: 1<br>
}
                    </div>
                </div>
            </div>
            
            <div class="operation-card">
                <div class="operation-header">UPDATE 変換パターン</div>
                <div class="operation-content">
                    <strong>Java → SQL</strong>
                    <div class="operation-example">
student.setEmail("new@example.com");<br>
student.setDepartmentId(2L);<br>
mapper.update(student);
                    </div>
                    <strong>自動生成SQL</strong>
                    <div class="operation-example">
UPDATE students SET<br>
    email = 'new@example.com',<br>
    department_id = 2,<br>
    updated_at = CURRENT_TIMESTAMP<br>
WHERE id = 1;
                    </div>
                </div>
            </div>
            
            <div class="operation-card">
                <div class="operation-header">DELETE 変換パターン</div>
                <div class="operation-content">
                    <strong>Java → SQL</strong>
                    <div class="operation-example">
mapper.delete(1L);
                    </div>
                    <strong>自動生成SQL</strong>
                    <div class="operation-example">
DELETE FROM students<br>
WHERE id = 1;
                    </div>
                    <strong>型安全性</strong>
                    <div class="operation-example">
// ❌ コンパイルエラーで防止<br>
mapper.delete("invalid");<br><br>
// ✅ Long型のみ受け入れ<br>
mapper.delete(1L);
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>
</html>