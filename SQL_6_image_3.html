<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LEFT JOINã®å®Ÿç”¨ä¾‹</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 20px;
            background: linear-gradient(135deg, #00b894 0%, #00cec9 100%);
            color: #333;
            line-height: 1.6;
        }
        .container {
            max-width: 1300px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
        }
        .title {
            text-align: center;
            color: #2c3e50;
            font-size: 26px;
            font-weight: bold;
            margin-bottom: 30px;
            padding-bottom: 15px;
            border-bottom: 3px solid #00b894;
        }
        .example-section {
            margin-bottom: 40px;
            background: #f8f9fa;
            border-radius: 12px;
            padding: 25px;
            border-left: 5px solid #00b894;
        }
        .example-title {
            font-size: 20px;
            font-weight: bold;
            color: #00b894;
            margin-bottom: 20px;
            padding: 10px;
            background: #e8f8f5;
            border-radius: 8px;
            text-align: center;
        }
        .scenario-box {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 20px;
        }
        .scenario-title {
            font-weight: bold;
            color: #856404;
            margin-bottom: 10px;
        }
        .sql-box {
            background: #2c3e50;
            color: #ecf0f1;
            padding: 15px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 13px;
            margin: 15px 0;
            border-left: 4px solid #00b894;
        }
        .result-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 13px;
            margin: 15px 0;
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        .result-table th, .result-table td {
            border: 1px solid #e9ecef;
            padding: 10px;
            text-align: center;
        }
        .result-table th {
            background: #00b894;
            color: white;
            font-weight: bold;
        }
        .null-highlight {
            background: #f8d7da !important;
            color: #721c24;
            font-style: italic;
            font-weight: bold;
        }
        .good-score {
            background: #d4edda !important;
            color: #155724;
            font-weight: bold;
        }
        .analysis-box {
            background: #d1ecf1;
            border: 1px solid #bee5eb;
            border-radius: 8px;
            padding: 15px;
            margin: 20px 0;
        }
        .analysis-title {
            font-weight: bold;
            color: #0c5460;
            margin-bottom: 10px;
            font-size: 16px;
        }
        .benefit-list {
            list-style: none;
            padding-left: 0;
        }
        .benefit-list li {
            padding: 5px 0;
            padding-left: 25px;
            position: relative;
        }
        .benefit-list li::before {
            content: "âœ“";
            position: absolute;
            left: 0;
            color: #00b894;
            font-weight: bold;
            font-size: 16px;
        }
        .comparison-container {
            display: flex;
            gap: 20px;
            margin: 20px 0;
        }
        .comparison-box {
            flex: 1;
            border-radius: 10px;
            padding: 15px;
            border: 2px solid;
        }
        .without-left-join {
            border-color: #e74c3c;
            background: #ffeaea;
        }
        .with-left-join {
            border-color: #00b894;
            background: #e8f8f5;
        }
        .comparison-title {
            font-weight: bold;
            text-align: center;
            padding: 8px;
            border-radius: 5px;
            margin-bottom: 15px;
        }
        .without-left-join .comparison-title {
            background: #e74c3c;
            color: white;
        }
        .with-left-join .comparison-title {
            background: #00b894;
            color: white;
        }
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        .stats-card {
            background: white;
            border-radius: 8px;
            padding: 15px;
            text-align: center;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            border-top: 4px solid #00b894;
        }
        .stats-number {
            font-size: 24px;
            font-weight: bold;
            color: #00b894;
        }
        .stats-label {
            font-size: 14px;
            color: #666;
            margin-top: 5px;
        }
        .practical-tip {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 8px;
            padding: 15px;
            margin: 20px 0;
            border-left: 5px solid #f39c12;
        }
        .tip-title {
            font-weight: bold;
            color: #856404;
            margin-bottom: 10px;
            font-size: 16px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="title">LEFT JOINå®Ÿç”¨ä¾‹ï¼šå…¨ä½“çŠ¶æ³æŠŠæ¡ã¨åˆ†ææ´»ç”¨</div>

        <!-- Example 1: å…¨å­¦ç”Ÿã®æˆç¸¾çŠ¶æ³ç¢ºèª -->
        <div class="example-section">
            <div class="example-title">ğŸ“Š å®Ÿç”¨ä¾‹1ï¼šå…¨å­¦ç”Ÿã®æˆç¸¾çŠ¶æ³ä¸€è¦§</div>
            
            <div class="scenario-box">
                <div class="scenario-title">ã‚·ãƒŠãƒªã‚ªï¼š</div>
                æ•™å“¡ãŒã€Œã‚¯ãƒ©ã‚¹å…¨ä½“ã®çŠ¶æ³ã‚’æŠŠæ¡ã—ãŸã„ã€‚æˆç¸¾ãŒã¾ã å…¥åŠ›ã•ã‚Œã¦ã„ãªã„å­¦ç”Ÿã‚‚å«ã‚ã¦ä¸€è¦§ã§ç¢ºèªã—ãŸã„ã€
            </div>

            <div class="comparison-container">
                <div class="comparison-box without-left-join">
                    <div class="comparison-title">âŒ INNER JOINã®å ´åˆ</div>
                    <div class="sql-box" style="font-size: 11px;">
                        SELECT s.name, COUNT(sc.id) as subjects <br>
                        FROM student s <br>
                        INNER JOIN score sc ON s.student_id = sc.student_id <br>
                        GROUP BY s.student_id;
                    </div>
                    <div style="font-size: 12px; color: #e74c3c;">
                        <strong>å•é¡Œï¼š</strong>æˆç¸¾æœªå…¥åŠ›ã®å­¦ç”ŸãŒè¡¨ç¤ºã•ã‚Œãªã„ï¼
                    </div>
                </div>

                <div class="comparison-box with-left-join">
                    <div class="comparison-title">âœ… LEFT JOINã®å ´åˆ</div>
                    <div class="sql-box" style="font-size: 11px;">
                        SELECT s.name, COUNT(sc.id) as subjects <br>
                        FROM student s <br>
                        LEFT JOIN score sc ON s.student_id = sc.student_id <br>
                        GROUP BY s.student_id;
                    </div>
                    <div style="font-size: 12px; color: #00b894;">
                        <strong>è§£æ±ºï¼š</strong>å…¨å­¦ç”Ÿã®çŠ¶æ³ã‚’æ¼ã‚Œãªãç¢ºèªå¯èƒ½ï¼
                    </div>
                </div>
            </div>

            <div class="sql-box">
                -- è©³ç´°ãªå­¦ç”ŸçŠ¶æ³ãƒ¬ãƒãƒ¼ãƒˆï¼ˆLEFT JOINæ´»ç”¨ï¼‰ <br>
                SELECT <br>
                &nbsp;&nbsp;&nbsp;&nbsp;s.student_id, <br>
                &nbsp;&nbsp;&nbsp;&nbsp;s.name, <br>
                &nbsp;&nbsp;&nbsp;&nbsp;s.department, <br>
                &nbsp;&nbsp;&nbsp;&nbsp;COUNT(sc.id) as subject_count, <br>
                &nbsp;&nbsp;&nbsp;&nbsp;ROUND(AVG(sc.score), 1) as average_score <br>
                FROM student s <br>
                LEFT JOIN score sc ON s.student_id = sc.student_id <br>
                WHERE s.status = 'active' <br>
                GROUP BY s.student_id, s.name, s.department <br>
                ORDER BY s.student_id;
            </div>

            <table class="result-table">
                <tr>
                    <th>student_id</th>
                    <th>name</th>
                    <th>department</th>
                    <th>subject_count</th>
                    <th>average_score</th>
                </tr>
                <tr>
                    <td>S001</td>
                    <td>ç”°ä¸­å¤ªéƒ</td>
                    <td>æƒ…å ±å·¥å­¦éƒ¨</td>
                    <td class="good-score">3</td>
                    <td class="good-score">88.3</td>
                </tr>
                <tr>
                    <td>S002</td>
                    <td>ä½è—¤èŠ±å­</td>
                    <td>çµŒå–¶å­¦éƒ¨</td>
                    <td class="good-score">3</td>
                    <td class="good-score">89.0</td>
                </tr>
                <tr>
                    <td>S003</td>
                    <td>å±±ç”°æ¬¡éƒ</td>
                    <td>æƒ…å ±å·¥å­¦éƒ¨</td>
                    <td class="good-score">2</td>
                    <td class="good-score">91.0</td>
                </tr>
                <tr>
                    <td>S004</td>
                    <td class="null-highlight">éˆ´æœ¨ç¾å’²</td>
                    <td>æ–‡å­¦éƒ¨</td>
                    <td class="null-highlight">0</td>
                    <td class="null-highlight">NULL</td>
                </tr>
                <tr>
                    <td>S005</td>
                    <td>é«˜æ©‹å¥å¤ª</td>
                    <td>æƒ…å ±å·¥å­¦éƒ¨</td>
                    <td class="good-score">3</td>
                    <td class="good-score">86.7</td>
                </tr>
                <tr>
                    <td>S006</td>
                    <td>ä¼Šè—¤éº»è¡£</td>
                    <td>çµŒå–¶å­¦éƒ¨</td>
                    <td class="good-score">2</td>
                    <td class="good-score">87.5</td>
                </tr>
            </table>

            <div class="analysis-box">
                <div class="analysis-title">ğŸ“ˆ LEFT JOINã«ã‚ˆã‚‹åˆ†æåŠ¹æœ</div>
                <ul class="benefit-list">
                    <li><strong>éˆ´æœ¨ç¾å’²ã•ã‚“</strong>ã®æˆç¸¾æœªå…¥åŠ›çŠ¶æ³ã‚’ç™ºè¦‹</li>
                    <li>å±¥ä¿®ç§‘ç›®æ•°ã®å·®ï¼ˆ0ã€œ3ç§‘ç›®ï¼‰ã‚’æŠŠæ¡</li>
                    <li>å­¦éƒ¨åˆ¥ã®å±¥ä¿®çŠ¶æ³ã‚’æ¯”è¼ƒå¯èƒ½</li>
                    <li>ãƒ•ã‚©ãƒ­ãƒ¼ãŒå¿…è¦ãªå­¦ç”Ÿã‚’ç‰¹å®š</li>
                </ul>
            </div>
        </div>

        <!-- Example 2: å­¦éƒ¨åˆ¥çµ±è¨ˆåˆ†æ -->
        <div class="example-section">
            <div class="example-title">ğŸ“ˆ å®Ÿç”¨ä¾‹2ï¼šå­¦éƒ¨åˆ¥çµ±è¨ˆåˆ†æ</div>
            
            <div class="scenario-box">
                <div class="scenario-title">ã‚·ãƒŠãƒªã‚ªï¼š</div>
                ç®¡ç†è€…ãŒã€Œå„å­¦éƒ¨ã®å±¥ä¿®çŠ¶æ³ã¨æˆç¸¾ã‚’æ¯”è¼ƒåˆ†æã—ãŸã„ã€‚åœ¨ç±å­¦ç”Ÿæ•°ã¨å®Ÿéš›ã®å±¥ä¿®è€…æ•°ã®é•ã„ã‚‚çŸ¥ã‚ŠãŸã„ã€
            </div>

            <div class="sql-box">
                -- å­¦éƒ¨åˆ¥è©³ç´°çµ±è¨ˆï¼ˆLEFT JOIN + é›†ç´„é–¢æ•°ï¼‰ <br>
                SELECT <br>
                &nbsp;&nbsp;&nbsp;&nbsp;s.department, <br>
                &nbsp;&nbsp;&nbsp;&nbsp;COUNT(DISTINCT s.student_id) as total_students, <br>
                &nbsp;&nbsp;&nbsp;&nbsp;COUNT(sc.id) as total_scores, <br>
                &nbsp;&nbsp;&nbsp;&nbsp;COUNT(DISTINCT CASE WHEN sc.id IS NOT NULL THEN s.student_id END) as active_students, <br>
                &nbsp;&nbsp;&nbsp;&nbsp;ROUND(AVG(sc.score), 1) as avg_score, <br>
                &nbsp;&nbsp;&nbsp;&nbsp;MAX(sc.score) as max_score, <br>
                &nbsp;&nbsp;&nbsp;&nbsp;MIN(sc.score) as min_score <br>
                FROM student s <br>
                LEFT JOIN score sc ON s.student_id = sc.student_id <br>
                WHERE s.status = 'active' <br>
                GROUP BY s.department <br>
                ORDER BY avg_score DESC;
            </div>

            <table class="result-table">
                <tr>
                    <th>department</th>
                    <th>total_students</th>
                    <th>total_scores</th>
                    <th>active_students</th>
                    <th>avg_score</th>
                    <th>max_score</th>
                    <th>min_score</th>
                </tr>
                <tr>
                    <td>æƒ…å ±å·¥å­¦éƒ¨</td>
                    <td class="good-score">4</td>
                    <td>11</td>
                    <td class="good-score">3</td>
                    <td class="good-score">89.1</td>
                    <td>96</td>
                    <td>78</td>
                </tr>
                <tr>
                    <td>çµŒå–¶å­¦éƒ¨</td>
                    <td class="good-score">2</td>
                    <td>5</td>
                    <td class="good-score">2</td>
                    <td class="good-score">88.2</td>
                    <td>95</td>
                    <td>80</td>
                </tr>
                <tr>
                    <td>æ–‡å­¦éƒ¨</td>
                    <td class="null-highlight">2</td>
                    <td class="null-highlight">1</td>
                    <td class="null-highlight">1</td>
                    <td class="null-highlight">78.0</td>
                    <td>78</td>
                    <td>78</td>
                </tr>
            </table>

            <div class="stats-grid">
                <div class="stats-card">
                    <div class="stats-number">75%</div>
                    <div class="stats-label">æƒ…å ±å·¥å­¦éƒ¨å±¥ä¿®ç‡<br>(3/4äºº)</div>
                </div>
                <div class="stats-card">
                    <div class="stats-number">100%</div>
                    <div class="stats-label">çµŒå–¶å­¦éƒ¨å±¥ä¿®ç‡<br>(2/2äºº)</div>
                </div>
                <div class="stats-card">
                    <div class="stats-number">50%</div>
                    <div class="stats-label">æ–‡å­¦éƒ¨å±¥ä¿®ç‡<br>(1/2äºº)</div>
                </div>
                <div class="stats-card">
                    <div class="stats-number">1äºº</div>
                    <div class="stats-label">æˆç¸¾æœªå…¥åŠ›<br>(éˆ´æœ¨ç¾å’²)</div>
                </div>
            </div>

            <div class="analysis-box">
                <div class="analysis-title">ğŸ“Š åˆ†æçµæœã®ãƒã‚¤ãƒ³ãƒˆ</div>
                <ul class="benefit-list">
                    <li><strong>æ–‡å­¦éƒ¨</strong>ã®å±¥ä¿®ç‡ãŒ50%ã¨ä½ã„ â†’ æŒ‡å°å¼·åŒ–ãŒå¿…è¦</li>
                    <li><strong>æƒ…å ±å·¥å­¦éƒ¨</strong>ã¯4äººä¸­1äººæœªå±¥ä¿® â†’ å€‹åˆ¥ãƒ•ã‚©ãƒ­ãƒ¼å¯¾è±¡ç‰¹å®š</li>
                    <li><strong>çµŒå–¶å­¦éƒ¨</strong>ã¯å…¨å“¡å±¥ä¿®æ¸ˆã¿ â†’ è‰¯å¥½ãªçŠ¶æ³</li>
                    <li>å­¦éƒ¨åˆ¥ã®æˆç¸¾å·®ã‚’æ•°å€¤ã§æŠŠæ¡ â†’ æ•™è‚²æ–¹é‡ã®è¦‹ç›´ã—æ¤œè¨</li>
                </ul>
            </div>
        </div>

        <!-- Example 3: NULLå€¤ã®æ´»ç”¨ -->
        <div class="example-section">
            <div class="example-title">ğŸ¯ å®Ÿç”¨ä¾‹3ï¼šNULLå€¤ã‚’æ´»ç”¨ã—ãŸæŠ½å‡ºãƒ»åˆ†æ</div>
            
            <div class="scenario-box">
                <div class="scenario-title">ã‚·ãƒŠãƒªã‚ªï¼š</div>
                ã€Œæˆç¸¾ãŒæœªå…¥åŠ›ã®å­¦ç”Ÿã‚’ç‰¹å®šã—ã¦ã€å€‹åˆ¥æŒ‡å°ã®å¯¾è±¡è€…ãƒªã‚¹ãƒˆã‚’ä½œæˆã—ãŸã„ã€
            </div>

            <div class="sql-box">
                -- æˆç¸¾æœªå…¥åŠ›å­¦ç”Ÿã®æŠ½å‡ºï¼ˆNULLå€¤ã®æ´»ç”¨ï¼‰ <br>
                SELECT <br>
                &nbsp;&nbsp;&nbsp;&nbsp;s.student_id, <br>
                &nbsp;&nbsp;&nbsp;&nbsp;s.name, <br>
                &nbsp;&nbsp;&nbsp;&nbsp;s.department, <br>
                &nbsp;&nbsp;&nbsp;&nbsp;s.email, <br>
                &nbsp;&nbsp;&nbsp;&nbsp;DATEDIFF(CURDATE(), s.enrollment_date) as days_since_enrollment <br>
                FROM student s <br>
                LEFT JOIN score sc ON s.student_id = sc.student_id <br>
                WHERE s.status = 'active' <br>
                GROUP BY s.student_id, s.name, s.department, s.email, s.enrollment_date <br>
                HAVING COUNT(sc.id) = 0 <br>
                ORDER BY days_since_enrollment DESC;
            </div>

            <table class="result-table">
                <tr>
                    <th>student_id</th>
                    <th>name</th>
                    <th>department</th>
                    <th>email</th>
                    <th>days_since_enrollment</th>
                </tr>
                <tr>
                    <td class="null-highlight">S004</td>
                    <td class="null-highlight">éˆ´æœ¨ç¾å’²</td>
                    <td class="null-highlight">æ–‡å­¦éƒ¨</td>
                    <td class="null-highlight">suzuki@example.com</td>
                    <td class="null-highlight">45</td>
                </tr>
            </table>

            <div class="practical-tip">
                <div class="tip-title">ğŸ’¡ å®Ÿå‹™ã§ã®æ´»ç”¨ãƒ†ã‚¯ãƒ‹ãƒƒã‚¯</div>
                <strong>COUNT(sc.id) = 0</strong> ã¨ <strong>HAVINGå¥</strong> ã®çµ„ã¿åˆã‚ã›ã§ã€LEFT JOINã®NULLå€¤ã‚’åŠ¹æœçš„ã«æ´»ç”¨ï¼
                <br><br>
                <ul class="benefit-list">
                    <li>åœ¨ç±45æ—¥çµŒéã—ã¦ã‚‚æˆç¸¾æœªå…¥åŠ› â†’ ç·Šæ€¥å¯¾å¿œãŒå¿…è¦</li>
                    <li>é€£çµ¡å…ˆãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚‚å–å¾— â†’ å³åº§ã«ãƒ•ã‚©ãƒ­ãƒ¼å¯èƒ½</li>
                    <li>å­¦éƒ¨æƒ…å ±ã‚‚å«ã‚€ â†’ å­¦éƒ¨åˆ¥æŒ‡å°æ–¹é‡ã®é©ç”¨</li>
                </ul>
            </div>
        </div>

        <div class="analysis-box">
            <div class="analysis-title">ğŸš€ Week 8ã¸ã®æº–å‚™ï¼šSpring Booté€£æºã§ã®æ´»ç”¨</div>
            <div style="background: #2c3e50; color: #ecf0f1; padding: 15px; border-radius: 8px; margin: 10px 0; font-family: 'Courier New', monospace; font-size: 12px;">
                // Week 8ã§ä½¿ç”¨äºˆå®šã®MyBatis Mapper <br>
                @Select("SELECT s.name, COUNT(sc.id) as subjectCount, " + <br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"AVG(sc.score) as avgScore " + <br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"FROM student s " + <br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"LEFT JOIN score sc ON s.student_id = sc.student_id " + <br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"GROUP BY s.student_id") <br>
                List&lt;StudentSummary&gt; findAllStudentsWithScoreSummary();
            </div>
            <p>LEFT JOINã«ã‚ˆã‚‹<strong>å…¨ä½“çŠ¶æ³æŠŠæ¡</strong>ã®ãƒ†ã‚¯ãƒ‹ãƒƒã‚¯ã¯ã€Spring Bootã®ç®¡ç†ç”»é¢é–‹ç™ºã§å¿…é ˆã®æŠ€è¡“ã§ã™ï¼</p>
        </div>
    </div>
</body>
</html>